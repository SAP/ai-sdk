---
id: rpt
title: SAP RPT-1 (Beta)
hide_title: false
hide_table_of_contents: false
description: How to use SAP Cloud SDK for AI to interact with the SAP RPT-1 model for Tabular AI on SAP AI Core.
keywords:
  - sap
  - cloud
  - sdk
  - ai
  - ai core
  - ai-api
  - rpt
  - rpt-1
  - tabular ai
  - relational pretrained transformer
---

:::important
This package is experimental and subject to change.
Do not use in production.
:::

The `@sap-ai-sdk/rpt` package provides a client to interact with [SAP-RPT-1](https://www.sap.com/products/artificial-intelligence/sap-rpt.html), SAPâ€™s Relational Pretrained Transformer model.

## Installation

To add the package to your project, run the following command in your terminal:

```bash
npm install @sap-ai-sdk/rpt
```

## Usage

SAP-RPT-1 is a relational pretrained transformer model that delivers accurate predictive insights from structured business data.
The following shows the different ways to use the RPT client to interact with the model.

### Client Initialization

Initialize a client using `RptClient` constructor with optional parameters.
By default, the 'sap-rpt-1-small' model is chosen as the prediction model.

```typescript
import { RptClient } from '@sap-ai-sdk/rpt';

const client = new RptClient();
```

To use the 'sap-rpt-1-large' model, specify the model name in the constructor:

```typescript
const client = new RptClient('sap-rpt-1-large');
```

Follow the instructions in the [Foundation Models documentation](./foundation-models#client-initialization)
to specify a model version, use a model with an explicit deployment ID, select a specific resource group, or target a custom AI Core instance.

### Predict With Schema

Use the `predictWithSchema()` method to make predictions with a schema explicitly defined.
Pass the data schema, and the prediction data including the prediction configuration and input data to the method.
Prefer providing the data schema if it is known instead of relying on the auto-inference solely based on the input data.

For information about custom request options such as compression, custom headers, or timeout, refer to the [Advanced Usage](#advanced-usage) section.

```typescript
const prediction = await client.predictWithSchema(
  // Data schema
  [
    { name: 'PRODUCT', dtype: 'string' },
    { name: 'PRICE', dtype: 'numeric' },
    { name: 'PRODUCTION_DATE', dtype: 'date' },
    { name: 'SALESGROUP', dtype: 'string' }
  ],
  // Prediction data
  {
    prediction_config: {
      target_columns: [
        {
          name: 'SALESGROUP',
          prediction_placeholder: '[PREDICT]',
          task_type: 'classification'
        }
      ]
    },
    index_column: '__row_idx__',
    rows: [
      {
        PRODUCT: 'Laptop',
        PRICE: 999.99,
        PRODUCTION_DATE: '2025-01-15',
        __row_idx__: '35',
        SALESGROUP: '[PREDICT]'
      },
      {
        PRODUCT: 'Desktop Computer',
        PRICE: 750.5,
        PRODUCTION_DATE: '2024-12-02',
        __row_idx__: '42',
        SALESGROUP: 'Enterprise Solutions'
      }
      // Additional rows...
    ]
  }
);
```

The data schema is a list of column definitions, each containing a `name` and a `dtype` properties.
The prediction data contains the following properties:

- `prediction_config`: A mandatory configuration to specify the columns to predict, including their names, placeholder values, and task types.
  The task type can be either `classification` or `regression`.
  If not specified, the model infers the task type based on the column data type.
- `index_column`: The name of the column that serves as the unique identifier for each row.
  The index column is returned in the prediction results to allow mapping predictions back to the input data.
- `rows` or `columns`: The input data to make predictions on.
  Use `rows` for row-based format or `columns` for column-based format.
- `parse_data_types`: Optional boolean to control data type parsing.
  When set to `true` (default), numeric columns are parsed to float or integer, and dates (`YYYY-MM-DD`) are parsed automatically.

:::important
When you store the schema and prediction data in variables, declare the schema with `as const` and use the `PredictionData<typeof schema>` type.
This enables type inference and accurate IDE autocompletion.
If you pass the data directly to `predictWithSchema()`, you do not need additional annotations.

Example:

```typescript
const schema = [...] as const;
const data: PredictionData<typeof schema> = {...};

client.predictWithSchema(schema, data);
```

:::

### Predict Without Schema

:::tip

If the data schema is known, it is recommended to use the [`predictWithSchema()` method](#predict-with-schema) instead.

:::

To make predictions without providing a schema, use the `predictWithoutSchema()` method.
Pass only the prediction data as a parameter.
The data schema will be inferred from the input data.

For information about custom request options such as compression, custom headers, or timeout, refer to the [Advanced Usage](#advanced-usage) section.

```typescript
const prediction = await client.predictWithoutSchema(
  // Prediction data
  {
    prediction_config: {
      target_columns: [
        {
          name: 'SALESGROUP',
          prediction_placeholder: '[PREDICT]',
          task_type: 'classification'
        }
      ]
    },
    index_column: '__row_idx__',
    rows: [
      {
        PRODUCT: 'Laptop',
        PRICE: 999.99,
        PRODUCTION_DATE: '2025-01-15',
        __row_idx__: '35',
        SALESGROUP: '[PREDICT]'
      },
      {
        PRODUCT: 'Desktop Computer',
        PRICE: 750.5,
        PRODUCTION_DATE: '2024-12-02',
        __row_idx__: '42',
        SALESGROUP: 'Enterprise Solutions'
      }
      // Additional rows...
    ]
  }
);
```

## Advanced Usage

The RPT client supports advanced features for specialized use cases.

### Request Compression

The RPT client automatically compresses prediction requests to improve performance for large datasets.
By default, requests with a body of 1024 bytes or larger are automatically compressed using `gzip`.

To customize compression settings, pass a `customRequest` parameter with a `requestCompression` configuration to the `predictWithSchema()` or `predictWithoutSchema()` methods:

```typescript
const prediction = await client.predictWithSchema(schema, predictionData, {
  requestCompression: {
    algorithm: 'zstd', // Use zstd instead of gzip
    mode: true, // Force compression regardless of payload size
    autoCompressMinSize: 2048 // Only compress payloads >= 2048 bytes (in 'auto' mode)
  }
});
```

### Custom Request Options

The `customRequest` parameter also supports additional HTTP request configuration options from the SAP Cloud SDK for JavaScript, such as:

- `headers`: Custom HTTP headers.
- `timeout`: Request timeout in milliseconds.
- `middlewares`: Custom HTTP middleware functions.

:::warning
The compression middleware is not applied when you provide custom middlewares.
Refer to the [Using Request Compression with Custom Middlewares](#using-request-compression-with-custom-middlewares) section for more details.
:::

Example with custom headers:

```typescript
const prediction = await client.predictWithSchema(schema, predictionData, {
  headers: {
    'x-custom-header': 'value'
  },
  timeout: 30000, // 30 seconds
  requestCompression: {
    algorithm: 'gzip'
  }
});
```

## Resilience

The `@sap-cloud-sdk/resilience` package provides built-in resilience features to handle transient failures and improve reliability.
For advanced resilience patterns, refer to the [SAP Cloud SDK documentation on resilience](https://sap.github.io/cloud-sdk/docs/js/guides/resilience).

### Retry

The HTTP client automatically retries failed requests on transient errors such as network issues or temporary server errors.
Customize retry behavior using the resilience library.

Set a custom retry count:

```typescript
import { retry } from '@sap-cloud-sdk/resilience';

const prediction = await client.predictWithSchema(schema, predictionData, {
  middlewares: [
    retry({ maxRetries: 3, backoffType: 'exponential', initialDelay: 1000 })
  ],
  requestCompression: {
    mode: false // Disable automatic compression when using custom middlewares
  }
});
```

### Timeout

Configure timeout for requests to prevent hanging connections.
The default timeout is 10 seconds.

```typescript
const prediction = await client.predictWithSchema(schema, predictionData, {
  timeout: 30000 // 30 seconds
});
```

### Combining Resilience Patterns

Combine multiple resilience patterns for comprehensive protection:

```typescript
import { retry, timeout, circuitBreaker } from '@sap-cloud-sdk/resilience';

const prediction = await client.predictWithSchema(schema, predictionData, {
  middlewares: [
    retry({ maxRetries: 3, backoffType: 'exponential', initialDelay: 1000 }),
    circuitBreaker({ failureThreshold: 5, recoveryTimeout: 60000 }),
    timeout(30000)
  ],
  requestCompression: {
    mode: false // Disable automatic compression when using custom middlewares
  }
});
```

### Using Request Compression with Custom Middlewares

:::tip
Place the compression middleware early in the middleware array, typically before resilience middleware such as retry and timeout.
This ensures the payload is compressed once and reused across retry attempts.
:::

When using custom middlewares, automatic compression is disabled.
To keep compression while using custom middlewares, manually add the compression middleware from `@sap-cloud-sdk/http-client`:

```typescript
import { retry, timeout } from '@sap-cloud-sdk/resilience';
import { compressRequest } from '@sap-cloud-sdk/http-client';

const prediction = await client.predictWithSchema(schema, predictionData, {
  middlewares: [
    compressRequest({ algorithm: 'gzip' }), // Manually add compression middleware
    retry({ maxRetries: 3, backoffType: 'exponential', initialDelay: 1000 }),
    timeout(30000)
  ],
  requestCompression: {
    mode: false // Disable automatic compression to avoid conflicts
  }
});
```
