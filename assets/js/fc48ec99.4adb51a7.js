"use strict";(self.webpackChunksap_ai_sdk_documentation=self.webpackChunksap_ai_sdk_documentation||[]).push([[5384],{3998:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>m,frontMatter:()=>i,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"ai-core/prompt-registry","title":"Prompt Registry","description":"How to manage the life cycle of your prompts in Prompt Registry using the SAP AI SDK for Java.","source":"@site/docs-java/ai-core/prompt-registry.mdx","sourceDirName":"ai-core","slug":"/ai-core/prompt-registry","permalink":"/ai-sdk/docs/java/ai-core/prompt-registry","draft":false,"unlisted":false,"editUrl":"https://github.com/SAP/ai-sdk/edit/main/docs-java/ai-core/prompt-registry.mdx","tags":[],"version":"current","frontMatter":{"id":"prompt-registry","title":"Prompt Registry","hide_title":false,"hide_table_of_contents":false,"description":"How to manage the life cycle of your prompts in Prompt Registry using the SAP AI SDK for Java.","keywords":["sap","cloud","sdk","ai"]},"sidebar":"docsJavaSidebar","previous":{"title":"Document Grounding","permalink":"/ai-sdk/docs/java/ai-core/document-grounding"},"next":{"title":"Getting Started with Agentic Workflows","permalink":"/ai-sdk/docs/java/tutorials/agentic-workflows"}}');var r=n(4848),o=n(8453);const i={id:"prompt-registry",title:"Prompt Registry",hide_title:!1,hide_table_of_contents:!1,description:"How to manage the life cycle of your prompts in Prompt Registry using the SAP AI SDK for Java.",keywords:["sap","cloud","sdk","ai"]},s=void 0,p={},l=[{value:"Introduction",id:"introduction",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Maven Dependencies",id:"maven-dependencies",level:3},{value:"Create a Prompt Template",id:"create-a-prompt-template",level:2},{value:"Update a Prompt Template",id:"update-a-prompt-template",level:2},{value:"Get a Prompt Template",id:"get-a-prompt-template",level:2},{value:"Get a Prompt Template History",id:"get-a-prompt-template-history",level:2},{value:"Use a Prompt Template",id:"use-a-prompt-template",level:2},{value:"Import a Prompt Template",id:"import-a-prompt-template",level:2},{value:"Export a Prompt Template",id:"export-a-prompt-template",level:2},{value:"Delete a Prompt Template",id:"delete-a-prompt-template",level:2},{value:"Using Templates in SpringAI",id:"using-templates-in-springai",level:2},{value:"Locally Test a Prompt Template",id:"locally-test-a-prompt-template",level:2},{value:"Orchestration Configurations in Prompt Registry",id:"orchestration-configurations-in-prompt-registry",level:2},{value:"Create an Orchestration Configuration",id:"create-an-orchestration-configuration",level:3},{value:"List Orchestration Configurations",id:"list-orchestration-configurations",level:3}];function c(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h2,{id:"introduction",children:"Introduction"}),"\n",(0,r.jsxs)(t.p,{children:["This guide provides examples on how to manage the life cycle of your prompts, from design to runtime in ",(0,r.jsx)(t.a,{href:"https://help.sap.com/docs/sap-ai-core/sap-ai-core-service-guide/prompt-registry",children:"Prompt Registry"}),"."]}),"\n",(0,r.jsx)(t.admonition,{type:"warning",children:(0,r.jsxs)(t.p,{children:["All classes in the ",(0,r.jsx)(t.code,{children:"...model"})," and ",(0,r.jsx)(t.code,{children:"...client"})," packages are generated from an OpenAPI specification.\nThese classes can be used, but no API stability guarantees are provided, even for minor releases.\nMaintenance and support are limited to ensuring consistency with the service specification.\nNo additional convenience API layer is provided."]})}),"\n",(0,r.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(t.p,{children:["Before using the Prompt Registry module, ensure that you have met all the general requirements outlined in the ",(0,r.jsx)(t.a,{href:"../overview-cloud-sdk-for-ai-java#general-requirements",children:"overview"}),".\nAdditionally, include the necessary Maven dependency in your project."]}),"\n",(0,r.jsx)(t.h3,{id:"maven-dependencies",children:"Maven Dependencies"}),"\n",(0,r.jsxs)(t.p,{children:["Add the following dependency to your ",(0,r.jsx)(t.code,{children:"pom.xml"})," file:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-xml",children:"<dependency>\n    <groupId>com.sap.ai.sdk</groupId>\n    <artifactId>prompt-registry</artifactId>\n    <version>${ai-sdk.version}</version>\n</dependency>\n"})}),"\n",(0,r.jsxs)(t.p,{children:["See ",(0,r.jsx)(t.a,{href:"https://github.com/SAP/ai-sdk-java/tree/main/sample-code/spring-app/pom.xml",children:"an example pom in our Spring Boot application"})]}),"\n",(0,r.jsx)(t.h2,{id:"create-a-prompt-template",children:"Create a Prompt Template"}),"\n",(0,r.jsx)(t.p,{children:"You can create a reusable prompt for a specific use case, including placeholders that are filled later."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-java",children:'PromptClient client = new PromptClient();\n\nvar spec =\n    PromptTemplateSpec.create()\n        .template(\n            SingleChatTemplate.create()\n                .role("system")\n                .content(\n                    "You classify input text into the two following categories: {{?categories}}"),\n            SingleChatTemplate.create().role("user").content("{{?inputExample}}"))\n        .defaults(Map.of("categories", "Finance, Tech, Sports"));\n\nvar template = PromptTemplatePostRequest.create()\n    .name("template-name")\n    .version("0.0.1")\n    .scenario("categorization")\n    .spec(spec);\n\nPromptTemplatePostResponse response = client.createUpdatePromptTemplate(template);\n'})}),"\n",(0,r.jsxs)(t.p,{children:["Refer to the ",(0,r.jsx)(t.a,{href:"https://github.com/SAP/ai-sdk-java/tree/main/sample-code/spring-app/src/main/java/com/sap/ai/sdk/app/controllers/PromptRegistryController.java",children:"PromptRegistryController.java"})," in our Spring Boot application for a complete example."]}),"\n",(0,r.jsx)(t.h2,{id:"update-a-prompt-template",children:"Update a Prompt Template"}),"\n",(0,r.jsxs)(t.p,{children:["To update an existing prompt template, you can use the same ",(0,r.jsx)(t.code,{children:"createUpdatePromptTemplate"})," method with the updated template details:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-java",children:'var updatedSpec = spec.defaults(Map.of("categories", "Finance, Tech, Sports, Politics"));\n\n// using the same version will save the old prompt in the history\n// using a new version will create a new prompt with a clean history\nvar updatedTemplate = template.spec(updatedSpec);\n\nPromptTemplatePostResponse response = client.createUpdatePromptTemplate(updatedTemplate);\n'})}),"\n",(0,r.jsxs)(t.p,{children:["Refer to the ",(0,r.jsx)(t.a,{href:"https://github.com/SAP/ai-sdk-java/tree/main/sample-code/spring-app/src/main/java/com/sap/ai/sdk/app/controllers/PromptRegistryController.java",children:"PromptRegistryController.java"})," in our Spring Boot application for a complete example."]}),"\n",(0,r.jsx)(t.h2,{id:"get-a-prompt-template",children:"Get a Prompt Template"}),"\n",(0,r.jsx)(t.p,{children:"You can retrieve a prompt template by ID, or by the combination of name, scenario, and version."}),"\n",(0,r.jsxs)(t.p,{children:["Prompt templates can also be retrieved and consumed in orchestration. For more information, see ",(0,r.jsx)(t.a,{href:"../orchestration/chat-completion#templating",children:"Templating"}),"."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-java",children:"PromptClient client = new PromptClient();\n\nPromptTemplateListResponse templates = client.listPromptTemplates();\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Refer to the ",(0,r.jsx)(t.a,{href:"https://github.com/SAP/ai-sdk-java/tree/main/sample-code/spring-app/src/main/java/com/sap/ai/sdk/app/controllers/PromptRegistryController.java",children:"PromptRegistryController.java"})," in our Spring Boot application for a complete example."]}),"\n",(0,r.jsx)(t.h2,{id:"get-a-prompt-template-history",children:"Get a Prompt Template History"}),"\n",(0,r.jsx)(t.p,{children:"You can list the history of edits to prompt templates, for imperatively managed prompt templates only."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-java",children:'PromptClient client = new PromptClient();\n\nPromptTemplateListResponse history = client.listPromptTemplateHistory("categorization", "0.0.1", NAME);\n'})}),"\n",(0,r.jsxs)(t.p,{children:["Refer to the ",(0,r.jsx)(t.a,{href:"https://github.com/SAP/ai-sdk-java/tree/main/sample-code/spring-app/src/main/java/com/sap/ai/sdk/app/controllers/PromptRegistryController.java",children:"PromptRegistryController.java"})," in our Spring Boot application for a complete example."]}),"\n",(0,r.jsx)(t.h2,{id:"use-a-prompt-template",children:"Use a Prompt Template"}),"\n",(0,r.jsx)(t.p,{children:"You can fill a prompt template by ID, or by the combination of name, scenario, and version."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-java",children:'PromptClient client = new PromptClient();\n\nPromptTemplateSubstitutionResponse substitution = client.parsePromptTemplateById(\n    "212a9b9b-a532-4c1c-8852-bf75de853d74",\n    false,\n    PromptTemplateSubstitutionRequest.create()\n        .inputParams(Map.of("inputExample", "I love football")));\n'})}),"\n",(0,r.jsxs)(t.p,{children:["Refer to the ",(0,r.jsx)(t.a,{href:"https://github.com/SAP/ai-sdk-java/tree/main/sample-code/spring-app/src/main/java/com/sap/ai/sdk/app/controllers/PromptRegistryController.java",children:"PromptRegistryController.java"})," in our Spring Boot application for a complete example."]}),"\n",(0,r.jsx)(t.h2,{id:"import-a-prompt-template",children:"Import a Prompt Template"}),"\n",(0,r.jsx)(t.p,{children:"You can import a declarative prompt template as a single file export in yaml format."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-java",children:'PromptClient client = new PromptClient();\n\nResource template = new ClassPathResource("prompt-template.yaml");\nPromptTemplatePostResponse response = client.importPromptTemplate(template.getFile());\n'})}),"\n",(0,r.jsxs)(t.p,{children:["Refer to the ",(0,r.jsx)(t.a,{href:"https://github.com/SAP/ai-sdk-java/tree/main/sample-code/spring-app/src/main/java/com/sap/ai/sdk/app/controllers/PromptRegistryController.java",children:"PromptRegistryController.java"})," in our Spring Boot application for a complete example."]}),"\n",(0,r.jsx)(t.h2,{id:"export-a-prompt-template",children:"Export a Prompt Template"}),"\n",(0,r.jsx)(t.p,{children:"You can export a prompt template as a single file export in declarative compatible yaml format."}),"\n",(0,r.jsx)(t.admonition,{type:"warning",children:(0,r.jsx)(t.p,{children:"Currently not working"})}),"\n",(0,r.jsx)(t.h2,{id:"delete-a-prompt-template",children:"Delete a Prompt Template"}),"\n",(0,r.jsx)(t.p,{children:"Delete a specific version of the prompt template, for imperatively managed prompt templates only."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-java",children:"PromptClient client = new PromptClient();\n\nPromptTemplateDeleteResponse response = client.deletePromptTemplate(template.getId())\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Refer to the ",(0,r.jsx)(t.a,{href:"https://github.com/SAP/ai-sdk-java/tree/main/sample-code/spring-app/src/main/java/com/sap/ai/sdk/app/controllers/PromptRegistryController.java",children:"PromptRegistryController.java"})," in our Spring Boot application for a complete example."]}),"\n",(0,r.jsx)(t.h2,{id:"using-templates-in-springai",children:"Using Templates in SpringAI"}),"\n",(0,r.jsx)(t.p,{children:"You can use prompt templates with input parameters in your Spring AI application."}),"\n",(0,r.jsxs)(t.p,{children:["Add the following dependency to your ",(0,r.jsx)(t.code,{children:"pom.xml"})," file:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.springframework.ai</groupId>\n    <artifactId>spring-ai-model</artifactId>\n</dependency>\n"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-java",children:'OpenAiClient openAiClient = OpenAiClient.forModel(OpenAiModel.GPT_4O_MINI);\nChatModel client = new OpenAiChatModel(openAiClient);\n\nvar repository = new InMemoryChatMemoryRepository();\nvar memory = MessageWindowChatMemory.builder().chatMemoryRepository(repository).build();\nvar advisor = MessageChatMemoryAdvisor.builder(memory).build();\nvar cl = ChatClient.builder(client).defaultAdvisors(advisor).build();\n\nvar promptResponse =\n        new PromptClient()\n            .parsePromptTemplateByNameVersion(\n                "scenario",\n                "0.0.1",\n                "template_name",\n                "resource-group",// usually "default"\n                false,\n                PromptTemplateSubstitutionRequest.create()\n                    .inputParams(Map.of("parameter1", "value1")));\n\nList<Message> messages = SpringAiConverter.promptTemplateToMessages(promptResponse);\nvar prompt = new Prompt(messages);\n\nGeneration response = cl.prompt(prompt).call().chatResponse().getResult();\n'})}),"\n",(0,r.jsxs)(t.p,{children:["Refer to the ",(0,r.jsx)(t.a,{href:"https://github.com/SAP/ai-sdk-java/tree/main/sample-code/spring-app/src/main/java/com/sap/ai/sdk/app/controllers/PromptRegistryController.java",children:"PromptRegistryController.java"})," in our Spring Boot application for a complete example."]}),"\n",(0,r.jsx)(t.h2,{id:"locally-test-a-prompt-template",children:"Locally Test a Prompt Template"}),"\n",(0,r.jsxs)(t.p,{children:["Note that you can also locally test a prompt, without needing it to be deployed in the Prompt Registry.\nFor more information, see ",(0,r.jsx)(t.a,{href:"../orchestration/chat-completion#locally-test-a-prompt-template",children:"the Orchestration documentation"}),"."]}),"\n",(0,r.jsx)(t.h2,{id:"orchestration-configurations-in-prompt-registry",children:"Orchestration Configurations in Prompt Registry"}),"\n",(0,r.jsxs)(t.p,{children:["The orchestration config API available as part of Prompt Registry allows to persist Orchestration configurations.\nOnce stored, you can reference and use them through your ",(0,r.jsx)(t.code,{children:"OrchestrationClient"})," instead of defining the configuration during runtime."]}),"\n",(0,r.jsxs)(t.p,{children:["Please refer to the ",(0,r.jsx)(t.a,{href:"../orchestration/chat-completion#using-a-prepared-configuration",children:"chapter on chat completion"})," for details on how to use a stored Orchestration configuration with your ",(0,r.jsx)(t.code,{children:"OrchestrationClient"}),"."]}),"\n",(0,r.jsxs)(t.p,{children:["For more details about orchestration configuration management, refer to the ",(0,r.jsx)(t.a,{href:"https://help.sap.com/docs/sap-ai-core/generative-ai/orchestration-config-management",children:"SAP AI Core documentation"}),"."]}),"\n",(0,r.jsx)(t.h3,{id:"create-an-orchestration-configuration",children:"Create an Orchestration Configuration"}),"\n",(0,r.jsx)(t.p,{children:"You can create a new Orchestration configuration in Prompt Registry as follows."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-java",children:'var orchConfigClient = new OrchestrationConfigClient();\nvar orchConfig = OrchestrationConfig.create()\n        .modules(\n            OrchestrationConfigModules.createInnerModuleConfigs(\n                ModuleConfigs.create()\n                    .promptTemplating(\n                        PromptTemplatingModuleConfig.create()\n                            .prompt(\n                                Template.create()\n                                    .template(\n                                        UserChatMessage.create()\n                                            .content(\n                                                new UserChatMessageContent.InnerString("message"))\n                                            .role(UserChatMessage.RoleEnum.USER)))\n                            .model(LLMModelDetails.create().name("model-name")))));\nvar postRequest =\n      OrchestrationConfigPostRequest.create()\n          .name("name")\n          .version("0.0.1")\n          .scenario("scenario")\n          .spec(buildOrchestrationConfig());\nOrchestrationConfigPostResponse response = orchConfigClient.createUpdateOrchestrationConfig(postRequest);\n'})}),"\n",(0,r.jsx)(t.h3,{id:"list-orchestration-configurations",children:"List Orchestration Configurations"}),"\n",(0,r.jsx)(t.p,{children:"You can list the saved Orchestration configurations as follows."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-java",children:"var orchConfigClient = new OrchestrationConfigClient();\nOrchestrationConfigListResponse response = orchConfigClient.listOrchestrationConfigs();\n"})})]})}function m(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>s});var a=n(6540);const r={},o=a.createContext(r);function i(e){const t=a.useContext(o);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),a.createElement(o.Provider,{value:t},e.children)}}}]);