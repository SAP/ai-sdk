"use strict";(self.webpackChunksap_ai_sdk_documentation=self.webpackChunksap_ai_sdk_documentation||[]).push([[6190],{4027:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"ai-core/document-grounding","title":"Document Grounding","description":"How to manage data in SAP Document Grounding using the SAP AI SDK for Java.","source":"@site/docs-java/ai-core/document-grounding.mdx","sourceDirName":"ai-core","slug":"/ai-core/document-grounding","permalink":"/ai-sdk/docs/java/ai-core/document-grounding","draft":false,"unlisted":false,"editUrl":"https://github.com/SAP/ai-sdk/edit/main/docs-java/ai-core/document-grounding.mdx","tags":[],"version":"current","frontMatter":{"id":"document-grounding","title":"Document Grounding","hide_title":false,"hide_table_of_contents":false,"description":"How to manage data in SAP Document Grounding using the SAP AI SDK for Java.","keywords":["sap","cloud","sdk","ai"]},"sidebar":"docsJavaSidebar","previous":{"title":"AI Core Deployment","permalink":"/ai-sdk/docs/java/ai-core/ai-core-deployment"},"next":{"title":"Prompt Registry","permalink":"/ai-sdk/docs/java/ai-core/prompt-registry"}}');var t=i(4848),r=i(8453);const o={id:"document-grounding",title:"Document Grounding",hide_title:!1,hide_table_of_contents:!1,description:"How to manage data in SAP Document Grounding using the SAP AI SDK for Java.",keywords:["sap","cloud","sdk","ai"]},s=void 0,c={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Maven Dependencies",id:"maven-dependencies",level:3},{value:"Usage",id:"usage",level:2},{value:"Data Ingestion",id:"data-ingestion",level:2},{value:"Pipeline API",id:"pipeline-api",level:3},{value:"Vector API",id:"vector-api",level:3},{value:"Collection creation",id:"collection-creation",level:4},{value:"Document creation",id:"document-creation",level:4},{value:"Document search",id:"document-search",level:4},{value:"Data Retrieval",id:"data-retrieval",level:2},{value:"Retrieval API",id:"retrieval-api",level:3},{value:"Grounding via Orchestration",id:"grounding-via-orchestration",level:3}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,t.jsxs)(n.p,{children:["This guide provides examples on how to manage data in ",(0,t.jsx)(n.a,{href:"https://help.sap.com/docs/sap-ai-core/generative-ai/data-management-apis-6348a01a930d414ab7ac7ab522d81eb5",children:"SAP Document Grounding"}),".\nIt's divided into two main sections: Data Ingestion and Data Retrieval."]}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsxs)(n.p,{children:["All classes in the ",(0,t.jsx)(n.code,{children:"...model"})," and ",(0,t.jsx)(n.code,{children:"...client"})," packages are generated from an OpenAPI specification.\nThese classes can be used, but no API stability guarantees are provided, even for minor releases.\nMaintenance and support are limited to ensuring consistency with the service specification.\nNo additional convenience API layer is provided."]})}),"\n",(0,t.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsxs)(n.p,{children:["Before using the Document Grounding module, ensure that you have met all the general requirements outlined in the ",(0,t.jsx)(n.a,{href:"../overview-cloud-sdk-for-ai-java#general-requirements",children:"overview"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Additionally, make sure your ",(0,t.jsx)(n.a,{href:"https://help.sap.com/docs/sap-ai-core/generative-ai/create-resource-group-for-grounding-e32efa5402154101b4cc05c03ef5be09",children:"resource group has the Document Grounding service enabled"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Finally, include the necessary Maven dependency in your project."}),"\n",(0,t.jsx)(n.h3,{id:"maven-dependencies",children:"Maven Dependencies"}),"\n",(0,t.jsxs)(n.p,{children:["Add the following dependency to your ",(0,t.jsx)(n.code,{children:"pom.xml"})," file:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"<dependency>\n    <groupId>com.sap.ai.sdk</groupId>\n    <artifactId>document-grounding</artifactId>\n    <version>${ai-sdk.version}</version>\n</dependency>\n"})}),"\n",(0,t.jsxs)(n.p,{children:["See ",(0,t.jsx)(n.a,{href:"https://github.com/SAP/ai-sdk-java/tree/main/sample-code/spring-app/pom.xml",children:"an example pom in our Spring Boot application"})]}),"\n",(0,t.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,t.jsx)(n.p,{children:"In addition to the prerequisites above, we assume you have already set up the following to carry out the examples in this guide:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"A running instance of SAP AI Core with correctly setup credentials, including a resource group id."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"data-ingestion",children:"Data Ingestion"}),"\n",(0,t.jsx)(n.p,{children:"The following APIs are available for data ingestion: Pipeline and Vector."}),"\n",(0,t.jsx)(n.h3,{id:"pipeline-api",children:"Pipeline API"}),"\n",(0,t.jsx)(n.p,{children:"Consider the following code sample to read pipelines, create a new one and get its status:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'var api = new GroundingClient().pipelines();\nvar resourceGroupId = "default";\n\n// get all pipelines\nPipelines pipelines = api.getAllPipelines(resourceGroupId);\n\n// create new pipeline\nvar type = "MSSharePoint"; // or "S3" or "SFTP"\nvar pipelineSecret = "my-secret-name";\nvar config = PipelinePostRequstConfiguration.create().destination(pipelineSecret);\nvar request = PipelinePostRequst.create().type(type)._configuration(config);\nPipelineId pipeline = api.createPipeline(resourceGroupId, request);\n\n// get pipeline status\nPipelineStatus status = api.getPipelineStatus(resourceGroupId, pipeline.getPipelineId());\n'})}),"\n",(0,t.jsx)(n.h3,{id:"vector-api",children:"Vector API"}),"\n",(0,t.jsx)(n.h4,{id:"collection-creation",children:"Collection creation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'String resourceGroupId;\nCollectionRequest collectionRequest;\n\nvar api = new GroundingClient().vector();\n\nOpenApiResponse documents = api.createCollection(resourceGroupId, collectionRequest);\nMap<String, List<String>> headers = documents.getHeaders();\n\nString locationHeader = headers.get("Location").get(0);\nString collectionId = locationHeader.replaceAll("^.*?/([a-f0-9-]+)/.*?$", "$1");\n'})}),"\n",(0,t.jsx)(n.h4,{id:"document-creation",children:"Document creation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'var api = new GroundingClient().vector();\nvar resourceGroupId = "default";\n\n// resolve collection id\nvar collectionId = UUID.fromString("12345-123-123-123-0123456abcdef");\n\nvar request =\n    DocumentCreateRequest.create()\n        .documents(BaseDocument.create()\n            .chunks(TextOnlyBaseChunk.create()\n               .content("The dog makes _woof_")\n               .metadata(VectorKeyValueListPair.create().key("animal").value("dog")))\n            .metadata(VectorDocumentKeyValueListPair.create().key("topic").value("sound")));\nDocumentsListResponse response = api.createDocuments(resourceGroupId, collectionId, request);\n'})}),"\n",(0,t.jsx)(n.h4,{id:"document-search",children:"Document search"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"String resourceGroup;\nTextSearchRequest textSearch;\n\nvar api = new GroundingClient().vector();\nvar result = api.search(resourceGroup, textSearch);\n\nString joinedContent = result.getResults().stream()\n  .flatMap(r -> r.getResults().stream())\n  .flatMap(r -> r.getDocuments().stream())\n  .flatMap(d -> d.getChunks().stream())\n  .map(VectorChunk::getContent)\n  .collect(Collectors.joining());\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Refer to the ",(0,t.jsx)(n.a,{href:"https://github.com/SAP/ai-sdk-java/tree/main/sample-code/spring-app/src/main/java/com/sap/ai/sdk/app/controllers/GroundingController.java",children:"GroundingController"})," in our Spring Boot application for a complete example."]}),"\n",(0,t.jsx)(n.h2,{id:"data-retrieval",children:"Data Retrieval"}),"\n",(0,t.jsx)(n.p,{children:"The following APIs are available for data retrieval: Retrieval and Orchestration."}),"\n",(0,t.jsx)(n.h3,{id:"retrieval-api",children:"Retrieval API"}),"\n",(0,t.jsx)(n.p,{children:"Consider the following code sample to search for relevant document grounding data based on a query:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'var api = new GroundingClient().retrieval();\nvar resourceGroupId = "default";\n\nvar filter =\n    RetrievalSearchFilter.create()\n        .id("question")\n        .dataRepositoryType(DataRepositoryType.VECTOR)\n        .dataRepositories(List.of("*"))\n        .searchConfiguration(SearchConfiguration.create().maxChunkCount(10));\nvar search = RetrievalSearchInput.create().query("What is SAP Cloud SDK for AI?").filters(filter);\nRetievalSearchResults results = api.search(resourceGroupId, search);\n'})}),"\n",(0,t.jsx)(n.h3,{id:"grounding-via-orchestration",children:"Grounding via Orchestration"}),"\n",(0,t.jsxs)(n.p,{children:["You can use the grounding service via orchestration.\nPlease find the ",(0,t.jsx)(n.a,{href:"../orchestration/chat-completion#grounding",children:"Orchestration documentation on grounding"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'OrchestrationClient client;\n\nvar databaseFilter =\n    DocumentGroundingFilter.create()\n        .dataRepositoryType(DataRepositoryType.VECTOR)\n        .searchConfig(GroundingFilterSearchConfiguration.create().maxChunkCount(3));\nvar groundingConfigConfig =\n    GroundingModuleConfigConfig.create()\n        .inputParams(List.of("query"))\n        .outputParam("results")\n        .addFiltersItem(databaseFilter);\nvar groundingConfig =\n    GroundingModuleConfig.create()\n        .type(GroundingModuleConfig.TypeEnum.DOCUMENT_GROUNDING_SERVICE)\n        .config(groundingConfigConfig);\nvar configWithGrounding =\n    new OrchestrationModuleConfig()\n        .withLlmConfig(GPT_4O)\n        .withGroundingConfig(groundingConfig);\n\nvar inputParams = Map.of("query", "What is SAP Cloud SDK for AI?");\n\nvar prompt =\n    new OrchestrationPrompt(\n        inputParams,\n        Message.system("Context message with embedded grounding results. {{?results}}"));\n\nOrchestrationChatResponse response = client.chatCompletion(prompt, configWithGrounding);\n'})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>s});var a=i(6540);const t={},r=a.createContext(t);function o(e){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);